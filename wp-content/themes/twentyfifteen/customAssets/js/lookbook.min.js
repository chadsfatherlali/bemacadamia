(function(g){g.fn.collagePlus=function(n){function k(a,f,c,i){for(var e=c.padding*(a.length-1)+a.length*a[0][3],m=(c.albumWidth-e)/(f-e),f=f<c.albumWidth?!0:!1,d=0;d<a.length;d++){var b=g(a[d][0]),h=Math.floor(a[d][1]*m),j=Math.floor(a[d][2]*m),k=!!(d<a.length-1);!0===c.allowPartialLastRow&&!0===f&&(h=a[d][1],j=a[d][2]);e+=h;!k&&e<c.albumWidth&&!(!0===c.allowPartialLastRow&&!0===f)&&(h+=c.albumWidth-e);h--;var l=b.is("img")?b:b.find("img");l.width(h);b.is("img")||b.width(h+a[d][3]);l.height(j);b.is("img")||
b.height(j+a[d][4]);b.css({"margin-bottom":c.padding+"px","margin-right":k?c.padding+"px":"0px",display:c.display,"vertical-align":"bottom",overflow:"hidden"});l.one("load",function(a){return function(){if("default"==c.effect)a.animate({opacity:"1"},{duration:c.fadeSpeed});else{var b="vertical"==c.direction?10>=i?i:10:9>=d?d+1:10;a.removeClass(function(a,b){return(b.match(/\beffect-\S+/g)||[]).join(" ")});a.addClass(c.effect);a.addClass("effect-duration-"+b)}}}(b)).each(function(){this.complete&&
g(this).trigger("load")})}}return this.each(function(){var a=0,f=[],c=1,i=g(this);g.fn.collagePlus.defaults.albumWidth=i.width();g.fn.collagePlus.defaults.padding=parseFloat(i.css("padding-left"));g.fn.collagePlus.defaults.images=i.children();var e=g.extend({},g.fn.collagePlus.defaults,n);e.images.each(function(i){var d=g(this),b=d.is("img")?d:g(this).find("img"),h="undefined"!=typeof b.data("width")?b.data("width"):b.width(),j="undefined"!=typeof b.data("height")?b.data("height"):b.height();$img=
g(b);d=[];d.w=parseFloat($img.css("border-left-width"))+parseFloat($img.css("border-right-width"));d.h=parseFloat($img.css("border-top-width"))+parseFloat($img.css("border-bottom-width"));b.data("width",h);b.data("height",j);b=Math.ceil(h/j*e.targetHeight);h=Math.ceil(e.targetHeight);f.push([this,b,h,d.w,d.h]);a+=b+d.w+e.padding;a>e.albumWidth&&0!=f.length&&(k(f,a-e.padding,e,c),delete a,delete f,a=0,f=[],c+=1);e.images.length-1==i&&0!=f.length&&(k(f,a,e,c),delete a,delete f,a=0,f=[],c+=1)})})};g.fn.collagePlus.defaults=
{targetHeight:400,fadeSpeed:"fast",display:"inline-block",effect:"default",direction:"vertical",allowPartialLastRow:!1}})(jQuery);(function(){})(jQuery);
